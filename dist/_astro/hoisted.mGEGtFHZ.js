import{c as ne,e as D,h as oe,q as U,f as k,w as W,k as X,l as re}from"./Header.astro_astro_type_script_index_0_lang.XyfUghZu.js";const F=document.querySelectorAll("[data-filter]"),N=Array.from(document.querySelectorAll(".gallery-item")),H=document.getElementById("gallery-prev"),q=document.getElementById("gallery-next"),_=document.getElementById("gallery-page-indicator"),J=document.getElementById("gallery-pagination");let T="Todos",m=1;const j=6;function C(){const a=N.filter(o=>T==="Todos"||o.dataset.category===T),e=Math.ceil(a.length/j)||1;m>e&&(m=e);const n=(m-1)*j,t=n+j;N.forEach(o=>o.style.display="none"),a.forEach((o,l)=>{l>=n&&l<t&&(o.style.display="block")}),_&&(_.textContent=`Página ${m} de ${e}`),H&&(H.disabled=m===1),q&&(q.disabled=m===e),J&&(J.style.display=e>1?"flex":"none")}F.forEach(a=>{a.addEventListener("click",()=>{F.forEach(e=>{e.classList.remove("bg-gold","text-white"),e.classList.add("bg-white","text-gray-600")}),a.classList.remove("bg-white","text-gray-600"),a.classList.add("bg-gold","text-white"),T=a.dataset.filter,m=1,C()})});H?.addEventListener("click",()=>{m>1&&(m--,C(),document.getElementById("galeria").scrollIntoView({behavior:"smooth"}))});q?.addEventListener("click",()=>{const a=N.filter(n=>T==="Todos"||n.dataset.category===T).length,e=Math.ceil(a/j);m<e&&(m++,C(),document.getElementById("galeria").scrollIntoView({behavior:"smooth"}))});C();const L={name:"Olhar o Sol",tagline:"Pizzaria",description:"O melhor sabor da cozinha regional e tradicional. Pizzas deliciosas, kebabs fascinantes e um ambiente acolhedor.",heroText:"Experiência gastronómica única em Riba d'Ave",aboutTitle:"Sobre Nós",aboutText:["Situado em Riba d'Ave, o Olhar o Sol é a referência gastronómica de excelência na região.","Num ambiente acolhedor e autêntico, a nossa equipa de profissionais dedicados elabora cada prato com ingredientes frescos criteriosamente selecionados. Conjugamos tradição artesanal e paixão pelo sabor para criar momentos inesquecíveis.","Descubra a experiência culinária que nos tornou referência. Venha partilhar a nossa paixão pela gastronomia de qualidade."],address:{street:"Rua das Agras n5",city:"Riba d'Ave",postalCode:"4765-181",country:"Portugal",googleMapsLink:"https://www.google.com/maps/place/Olhar+o+Sol/@41.393992,-8.3942252,17z/data=!3m1!4b1!4m6!3m5!1s0xd24f14a1a62c0f5:0xda13ff942c2d5543!8m2!3d41.393988!4d-8.3916503!16s%2Fg%2F11clgj_q5s?hl=pt&entry=ttu",embedLink:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2994.4842971276!2d-8.3942252!3d41.393992!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd24f14a1a62c0f5%3A0xda13ff942c2d5543!2sOlhar%20o%20Sol!5e0!3m2!1spt-PT!2spt!4v1709876543210!5m2!1spt-PT!2spt"},contact:{phone:"+351 918 804 459",email:"olharosol.07@gmail.com",facebook:"https://www.facebook.com/pizzariaOlharoSol/",instagram:"https://www.instagram.com/olharosolpizzaria/"},hours:{segunda_terca:"Encerrado",quarta_quinta:"11:00 - 15:00 • 18:00 - 23:00",sexta_sabado:"11:00 - 24:00",domingo:"18:00 - 23:00"},seo:{keywords:"pizzaria, kebabs, Riba d'Ave, restaurante, Olhar o Sol, pizza, gastronomia",author:"Olhar o Sol"},images:{logo:"/images/gallery/logo.jpg",hero:"/images/gallery/16.jpg",cover:"/images/gallery/restaurante.jpg",gallery:[{src:"/images/gallery/1.jpg",alt:"Prato de Peixe"},{src:"/images/gallery/restaurante.jpg",alt:"Nossa Sala Principal"},{src:"/images/gallery/2.jpg",alt:"Salgadinhos Tradicionais"},{src:"/images/gallery/3.jpg",alt:"Prato de Carne com Batatas"},{src:"/images/gallery/4.jpg",alt:"Salada de Atum"},{src:"/images/gallery/restaurante1.jpg",alt:"Ambiente Acolhedor"},{src:"/images/gallery/5.jpg",alt:"Picanha na Tábua"},{src:"/images/gallery/6.jpg",alt:"Hambúrguer Gourmet"},{src:"/images/gallery/7.jpg",alt:"Kebab Dürüm"},{src:"/images/gallery/restaurante2.jpg",alt:"Nossa Esplanada"},{src:"/images/gallery/8.jpg",alt:"Prato de Massa"},{src:"/images/gallery/9.jpg",alt:"Prato Combinado"},{src:"/images/gallery/10.jpg",alt:"Salada Olhar o Sol"},{src:"/images/gallery/restaurante3.jpg",alt:"Decoração Olhar o Sol"},{src:"/images/gallery/11.jpg",alt:"Bifana Especial"},{src:"/images/gallery/12.jpg",alt:"Petiscos Variados"},{src:"/images/gallery/13.jpg",alt:"Prato de Bacalhau"},{src:"/images/gallery/14.jpg",alt:"Grelhada Mista"},{src:"/images/gallery/15.jpg",alt:"Francesinha Olhar o Sol"}]}},P=document.getElementById("reservation-form"),u=document.getElementById("res-date"),v=document.getElementById("res-time"),b=document.getElementById("slots-container"),w=document.getElementById("contact-step"),z=document.getElementById("date-error"),Y=document.getElementById("success-message"),ie=document.getElementById("reset-form"),O=document.getElementById("loading-overlay"),f=document.getElementById("res-guests"),le=30;let r={closedDays:[0,1],maxGuests:8,minAdvance:30,resDuration:60,vacationStart:null,vacationEnd:null,lunch:{start:12,end:15},dinner:{start:19,end:22},tables:[]};const ce=ne(D,"settings","general");oe(ce,a=>{if(a.exists()){const e=a.data();e.closedDays&&(r.closedDays=e.closedDays),e.maxGuests&&(r.maxGuests=e.maxGuests),e.minAdvance!==void 0&&(r.minAdvance=e.minAdvance),e.resDuration!==void 0&&(r.resDuration=e.resDuration),r.vacationStart=e.vacationStart||null,r.vacationEnd=e.vacationEnd||null,e.lunchStart&&(r.lunch.start=e.lunchStart),e.lunchEnd&&(r.lunch.end=e.lunchEnd),e.dinnerStart&&(r.dinner.start=e.dinnerStart),e.dinnerEnd&&(r.dinner.end=e.dinnerEnd),r.tables=e.tables||[],de(),u.value&&$(u.value)}});function de(){const a=parseInt(f.value)||2;f.innerHTML="";for(let n=1;n<=r.maxGuests;n++){const t=document.createElement("option");t.value=n.toString(),t.textContent=n+(n===1?" Pessoa":" Pessoas"),f.appendChild(t)}const e=Math.min(a,r.maxGuests);f.value=e>0?e.toString():"1"}function ge(a,e){if(e.find(o=>o.capacity>=a))return!0;const t=e.filter(o=>o.combinable!==!1);for(let o=0;o<t.length;o++)for(let l=o+1;l<t.length;l++)if(t[o].capacity+t[l].capacity>=a)return!0;if(t.length>=3){for(let o=0;o<t.length;o++)for(let l=o+1;l<t.length;l++)for(let d=l+1;d<t.length;d++)if(t[o].capacity+t[l].capacity+t[d].capacity>=a)return!0}return!1}function me(a,e){const n=e.filter(s=>s.capacity>=a).sort((s,i)=>s.capacity-i.capacity);if(n.length>0)return{tables:[n[0]],totalCapacity:n[0].capacity};const t=e.filter(s=>s.combinable!==!1);let o=null,l=1/0;for(let s=0;s<t.length;s++)for(let i=s+1;i<t.length;i++){const g=t[s].capacity+t[i].capacity;g>=a&&g<l&&(o=[t[s],t[i]],l=g)}if(o)return{tables:o,totalCapacity:l};let d=null,c=1/0;if(t.length>=3)for(let s=0;s<t.length;s++)for(let i=s+1;i<t.length;i++)for(let g=i+1;g<t.length;g++){const p=t[s].capacity+t[i].capacity+t[g].capacity;p>=a&&p<c&&(d=[t[s],t[i],t[g]],c=p)}return d?{tables:d,totalCapacity:c}:null}function K(a){const e=[];let n=a.start*60;const t=a.end*60;for(;n<t;){const o=Math.floor(n/60),l=n%60,d=`${o.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`;e.push(d),n+=le}return e}u.min=new Date().toISOString().split("T")[0];u.addEventListener("change",a=>{$(a.target.value)});f.addEventListener("change",()=>{u.value&&$(u.value)});async function $(a){if(!a)return;const n=new Date(a).getDay();if(b.innerHTML='<div class="col-span-4 text-center py-2"><span class="animate-pulse text-gold">Verificando disponibilidade...</span></div>',v.value="",w.classList.add("hidden"),z.classList.add("hidden"),r.closedDays.includes(n)){Q("O restaurante encontra-se encerrado. Não é possível efetuar reservas.");return}if(r.vacationStart&&r.vacationEnd){const c=new Date(r.vacationStart),s=new Date(r.vacationEnd);c.setHours(0,0,0,0),s.setHours(23,59,59,999);const i=new Date(a);if(i.setHours(12,0,0,0),i>=c&&i<=s){Q("Estamos encerrados para férias neste período.");return}}let t=[];try{const c=U(k(D,"reservations"),W("date","==",a));(await X(c)).forEach(i=>{const g=i.data();t.push({time:g.time,assignedTable:g.assignedTable||null})})}catch(c){console.error("Error fetching availability:",c)}if(!r.tables||r.tables.length===0){b.innerHTML='<div class="col-span-4 text-center text-red-500 bg-red-50 p-4 rounded-lg border border-red-100 text-sm">O restaurante ainda não configurou as mesas. Por favor, tente mais tarde.</div>';return}b.innerHTML="";const o=K(r.lunch),l=K(r.dinner),d=[...o,...l];if(d.length===0){b.innerHTML='<div class="col-span-4 text-center text-gray-500 py-2">Não há horários disponíveis para hoje.</div>';return}d.forEach(c=>{const s=document.createElement("button");s.type="button",s.className="py-3 px-2 rounded-xl border text-sm font-medium transition-all hover:border-gold hover:bg-gold/5 active:scale-95 touch-manipulation",s.textContent=c;const[i,g]=c.split(":").map(Number),p=new Date(a);p.setHours(i,g,0,0);const M=new Date,h=r.minAdvance*60*1e3;if(p.getTime()-M.getTime()<h)s.disabled=!0,s.classList.add("bg-gray-100","text-gray-400","cursor-not-allowed","line-through"),s.title="Horário já passou ou muito próximo";else{const E=parseInt(f.value),A=i*60+g,I=r.resDuration||60,x=[];t.forEach(S=>{if(S.assignedTable){const[Z,ee]=S.time.split(":").map(Number),V=Z*60+ee,te=V+I,R=A,ae=R+I;if(V<ae&&R<te){const se=S.assignedTable.split("+");x.push(...se)}}});const B=r.tables.filter(S=>!x.includes(S.id));ge(E,B)?s.onclick=()=>ue(s,c):(s.disabled=!0,s.classList.add("bg-gray-100","text-gray-400","cursor-not-allowed","line-through"),s.title="Esgotado")}b.appendChild(s)})}function Q(a){b.innerHTML="",z.textContent=a,z.classList.remove("hidden"),u.value=""}function ue(a,e){Array.from(b.children).forEach(n=>{n.disabled||(n.className="py-3 px-2 rounded-xl border text-sm font-medium transition-all hover:border-gold hover:bg-gold/5 active:scale-95 touch-manipulation")}),a.className="py-3 px-2 rounded-xl border bg-gold text-white border-gold shadow-md transform scale-105 z-10",v.value=e,w.classList.remove("hidden"),setTimeout(()=>{w.classList.add("opacity-100"),w.scrollIntoView({behavior:"smooth",block:"nearest"})},50)}P.addEventListener("submit",async a=>{if(a.preventDefault(),!v.value){alert("Por favor selecione um horário");return}O.classList.remove("hidden");try{const e={date:u.value,time:v.value,guests:parseInt(f.value)||2,name:document.getElementById("res-name").value,email:document.getElementById("res-email").value,phone:document.getElementById("res-phone").value,createdAt:new Date,to:[document.getElementById("res-email").value],cc:[L.contact.email],message:{subject:`Reserva Confirmada - ${L.name} (${u.value})`,html:`
                    <div style="font-family: sans-serif; color: #333;">
                        <h2 style="color: #D4AF37;">Reserva Confirmada</h2>
                        <p>Olá <strong>${document.getElementById("res-name").value}</strong>,</p>
                        <p>A sua reserva no <strong>${L.name}</strong> foi registada com sucesso.</p>
                        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
                        <ul>
                            <li><strong>Data:</strong> ${u.value}</li>
                            <li><strong>Hora:</strong> ${v.value}</li>
                            <li><strong>Pessoas:</strong> ${f.value}</li>
                        </ul>
                        <p>Se precisar de cancelar, por favor contacte-nos por telefone: ${L.contact.phone}.</p>
                        <p><em>Obrigado pela preferência!</em></p>
                    </div>
                `}};if(r.tables&&r.tables.length>0){const n=parseInt(f.value),t=v.value,[o,l]=t.split(":").map(Number),d=o*60+l,c=r.resDuration||60,s=d+c,i=U(k(D,"reservations"),W("date","==",u.value)),g=await X(i),p=[];g.forEach(y=>{const E=y.data();if(E.assignedTable){const[A,I]=E.time.split(":").map(Number),x=A*60+I,B=x+c;if(x<s&&d<B){const G=E.assignedTable.split("+");p.push(...G)}}});const M=r.tables.filter(y=>!p.includes(y.id)),h=me(n,M);if(!h){alert("Desculpe, não há mesas disponíveis para este período. Por favor escolha outro horário."),O.classList.add("hidden");return}h.tables.length===1?(e.assignedTable=h.tables[0].id,e.assignedTableName=h.tables[0].name):(e.assignedTable=h.tables.map(y=>y.id).join("+"),e.assignedTableName=h.tables.map(y=>y.name).join(" + "))}await re(k(D,"reservations"),e),P.classList.add("hidden"),Y.classList.remove("hidden")}catch(e){console.error("Error writing document: ",e),e&&typeof e=="object"?JSON.stringify(e):String(e);const n=e&&e.message||String(e),t=e&&e.code||"unknown";alert(`Ocorreu um erro ao registar a reserva.

Detalhes: ${n}
Código: ${t}

Por favor, tire uma captura de ecrã deste erro.`)}finally{O.classList.add("hidden")}});ie.addEventListener("click",()=>{P.reset(),b.innerHTML='<div class="col-span-4 text-gray-400 text-sm italic p-2 border border-dashed rounded text-center">Selecione uma data para ver disponibilidade</div>',v.value="",w.classList.add("hidden","opacity-0"),P.classList.remove("hidden"),Y.classList.add("hidden")});
