import{c as Q,e as L,h as U,q,f as A,w as $,k as G,l as W}from"./Header.astro_astro_type_script_index_0_lang.CWiViGhs.js";const D={name:"Olhar o Sol",tagline:"Pizzaria",description:"O melhor sabor da cozinha regional e tradicional. Pizzas deliciosas, kebabs fascinantes e um ambiente acolhedor.",heroText:"Experiência gastronómica única em Riba d'Ave",aboutTitle:"Sobre Nós",aboutText:["Situado em Riba d'Ave, o Olhar o Sol é a referência gastronómica de excelência na região.","Num ambiente acolhedor e autêntico, a nossa equipa de profissionais dedicados elabora cada prato com ingredientes frescos criteriosamente selecionados. Conjugamos tradição artesanal e paixão pelo sabor para criar momentos inesquecíveis.","Descubra a experiência culinária que nos tornou referência. Venha partilhar a nossa paixão pela gastronomia de qualidade."],address:{street:"Rua das Agras n5",city:"Riba d'Ave",postalCode:"4765-181",country:"Portugal",googleMapsLink:"https://www.google.com/maps/place/Olhar+o+Sol/@41.393992,-8.3942252,17z/data=!3m1!4b1!4m6!3m5!1s0xd24f14a1a62c0f5:0xda13ff942c2d5543!8m2!3d41.393988!4d-8.3916503!16s%2Fg%2F11clgj_q5s?hl=pt&entry=ttu",embedLink:"https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2994.4842971276!2d-8.3942252!3d41.393992!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd24f14a1a62c0f5%3A0xda13ff942c2d5543!2sOlhar%20o%20Sol!5e0!3m2!1spt-PT!2spt!4v1709876543210!5m2!1spt-PT!2spt"},contact:{phone:"+351 918 804 459",email:"olharosol.07@gmail.com",facebook:"https://www.facebook.com/pizzariaOlharoSol/",instagram:"https://www.instagram.com/olharosolpizzaria/"},hours:{segunda_terca:"Encerrado",quarta_quinta:"11:00 - 15:00 • 18:00 - 23:00",sexta_sabado:"11:00 - 24:00",domingo:"18:00 - 23:00"},seo:{keywords:"pizzaria, kebabs, Riba d'Ave, restaurante, Olhar o Sol, pizza, gastronomia",author:"Olhar o Sol"},images:{logo:"/images/gallery/logo.jpg",hero:"/images/gallery/16.jpg",cover:"/images/gallery/restaurante.jpg",gallery:[{src:"/images/gallery/1.jpg",alt:"Prato de Peixe"},{src:"/images/gallery/restaurante.jpg",alt:"Nossa Sala Principal"},{src:"/images/gallery/2.jpg",alt:"Salgadinhos Tradicionais"},{src:"/images/gallery/3.jpg",alt:"Prato de Carne com Batatas"},{src:"/images/gallery/4.jpg",alt:"Salada de Atum"},{src:"/images/gallery/restaurante1.jpg",alt:"Ambiente Acolhedor"},{src:"/images/gallery/5.jpg",alt:"Picanha na Tábua"},{src:"/images/gallery/6.jpg",alt:"Hambúrguer Gourmet"},{src:"/images/gallery/7.jpg",alt:"Kebab Dürüm"},{src:"/images/gallery/restaurante2.jpg",alt:"Nossa Esplanada"},{src:"/images/gallery/8.jpg",alt:"Prato de Massa"},{src:"/images/gallery/9.jpg",alt:"Prato Combinado"},{src:"/images/gallery/10.jpg",alt:"Salada Olhar o Sol"},{src:"/images/gallery/restaurante3.jpg",alt:"Decoração Olhar o Sol"},{src:"/images/gallery/11.jpg",alt:"Bifana Especial"},{src:"/images/gallery/12.jpg",alt:"Petiscos Variados"},{src:"/images/gallery/13.jpg",alt:"Prato de Bacalhau"},{src:"/images/gallery/14.jpg",alt:"Grelhada Mista"},{src:"/images/gallery/15.jpg",alt:"Francesinha Olhar o Sol"}]}},j=document.getElementById("reservation-form"),m=document.getElementById("res-date"),y=document.getElementById("res-time"),b=document.getElementById("slots-container"),T=document.getElementById("contact-step"),B=document.getElementById("date-error"),R=document.getElementById("success-message"),X=document.getElementById("reset-form"),v=document.getElementById("loading-overlay"),p=document.getElementById("res-guests"),Y=30;let n={closedDays:[0,1],maxGuests:8,minAdvance:30,resDuration:60,vacationStart:null,vacationEnd:null,lunch:{start:12,end:15},dinner:{start:19,end:22},tables:[]};const Z=Q(L,"settings","general");U(Z,s=>{if(s.exists()){const e=s.data();e.closedDays&&(n.closedDays=e.closedDays),e.maxGuests&&(n.maxGuests=e.maxGuests),e.minAdvance!==void 0&&(n.minAdvance=e.minAdvance),e.resDuration!==void 0&&(n.resDuration=e.resDuration),n.vacationStart=e.vacationStart||null,n.vacationEnd=e.vacationEnd||null,e.lunchStart&&(n.lunch.start=e.lunchStart),e.lunchEnd&&(n.lunch.end=e.lunchEnd),e.dinnerStart&&(n.dinner.start=e.dinnerStart),e.dinnerEnd&&(n.dinner.end=e.dinnerEnd),n.tables=e.tables||[],ee(),m.value&&P(m.value)}});function ee(){const s=parseInt(p.value)||2;p.innerHTML="";for(let o=1;o<=n.maxGuests;o++){const a=document.createElement("option");a.value=o.toString(),a.textContent=o+(o===1?" Pessoa":" Pessoas"),p.appendChild(a)}const e=Math.min(s,n.maxGuests);p.value=e>0?e.toString():"1"}function ae(s,e){if(e.find(r=>r.capacity>=s))return!0;const a=e.filter(r=>r.combinable!==!1);for(let r=0;r<a.length;r++)for(let i=r+1;i<a.length;i++)if(a[r].capacity+a[i].capacity>=s)return!0;if(a.length>=3){for(let r=0;r<a.length;r++)for(let i=r+1;i<a.length;i++)for(let d=i+1;d<a.length;d++)if(a[r].capacity+a[i].capacity+a[d].capacity>=s)return!0}return!1}function te(s,e){const o=e.filter(t=>t.capacity>=s).sort((t,l)=>t.capacity-l.capacity);if(o.length>0)return{tables:[o[0]],totalCapacity:o[0].capacity};const a=e.filter(t=>t.combinable!==!1);let r=null,i=1/0;for(let t=0;t<a.length;t++)for(let l=t+1;l<a.length;l++){const g=a[t].capacity+a[l].capacity;g>=s&&g<i&&(r=[a[t],a[l]],i=g)}if(r)return{tables:r,totalCapacity:i};let d=null,c=1/0;if(a.length>=3)for(let t=0;t<a.length;t++)for(let l=t+1;l<a.length;l++)for(let g=l+1;g<a.length;g++){const u=a[t].capacity+a[l].capacity+a[g].capacity;u>=s&&u<c&&(d=[a[t],a[l],a[g]],c=u)}return d?{tables:d,totalCapacity:c}:null}function N(s){const e=[];let o=s.start*60;const a=s.end*60;for(;o<a;){const r=Math.floor(o/60),i=o%60,d=`${r.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`;e.push(d),o+=Y}return e}m.min=new Date().toISOString().split("T")[0];m.addEventListener("change",s=>{P(s.target.value)});p.addEventListener("change",()=>{m.value&&P(m.value)});async function P(s){if(!s)return;const o=new Date(s).getDay();if(b.innerHTML='<div class="col-span-full text-center py-4"><span class="animate-pulse text-gold">Verificando disponibilidade...</span></div>',y.value="",T.classList.add("hidden"),B.classList.add("hidden"),n.closedDays.includes(o)){z("O restaurante encontra-se encerrado neste dia.");return}if(n.vacationStart&&n.vacationEnd){const c=new Date(n.vacationStart),t=new Date(n.vacationEnd);c.setHours(0,0,0,0),t.setHours(23,59,59,999);const l=new Date(s);if(l.setHours(12,0,0,0),l>=c&&l<=t){z("Estamos encerrados para férias neste período.");return}}let a=[];try{const c=q(A(L,"reservations"),$("date","==",s));(await G(c)).forEach(l=>{const g=l.data();a.push({time:g.time,assignedTable:g.assignedTable||null})})}catch(c){console.error("Error fetching availability:",c)}if(!n.tables||n.tables.length===0){b.innerHTML='<div class="col-span-full text-center text-red-500 bg-red-50 p-4 rounded-lg text-sm">O restaurante ainda não configurou as mesas.</div>';return}b.innerHTML="";const r=N(n.lunch),i=N(n.dinner),d=[...r,...i];if(d.length===0){b.innerHTML='<div class="col-span-full text-center text-gray-500 py-4">Não há horários disponíveis.</div>';return}d.forEach(c=>{const t=document.createElement("button");t.type="button",t.className="py-3 px-2 rounded-lg border border-gray-200 text-sm font-medium transition-all hover:border-gold hover:bg-gold/5 active:scale-95 bg-neutral-50",t.textContent=c;const[l,g]=c.split(":").map(Number),u=new Date(s);u.setHours(l,g,0,0);const I=new Date,f=n.minAdvance*60*1e3;if(u.getTime()-I.getTime()<f)t.disabled=!0,t.classList.add("bg-gray-100","text-gray-300","cursor-not-allowed","line-through");else{const x=parseInt(p.value),M=l*60+g,w=n.resDuration||60,S=[];a.forEach(E=>{if(E.assignedTable){const[V,_]=E.time.split(":").map(Number),H=V*60+_,F=H+w,k=M,K=k+w;if(H<K&&k<F){const J=E.assignedTable.split("+");S.push(...J)}}});const C=n.tables.filter(E=>!S.includes(E.id));ae(x,C)?t.onclick=()=>se(t,c):(t.disabled=!0,t.classList.add("bg-gray-100","text-gray-300","cursor-not-allowed","line-through"))}b.appendChild(t)})}function z(s){b.innerHTML="",B.textContent=s,B.classList.remove("hidden"),m.value=""}function se(s,e){Array.from(b.children).forEach(o=>{o.disabled||(o.className="py-3 px-2 rounded-lg border border-gray-200 text-sm font-medium transition-all hover:border-gold hover:bg-gold/5 active:scale-95 bg-neutral-50")}),s.className="py-3 px-2 rounded-lg border bg-gold text-white border-gold shadow-md transform scale-105",y.value=e,T.classList.remove("hidden"),setTimeout(()=>{T.classList.add("opacity-100"),T.scrollIntoView({behavior:"smooth",block:"nearest"})},50)}j.addEventListener("submit",async s=>{if(s.preventDefault(),!y.value){alert("Por favor selecione um horário");return}v.classList.remove("hidden"),v.classList.add("flex");try{const e={date:m.value,time:y.value,guests:parseInt(p.value)||2,name:document.getElementById("res-name").value,email:document.getElementById("res-email").value,phone:document.getElementById("res-phone").value,createdAt:new Date,to:[document.getElementById("res-email").value],cc:[D.contact.email],message:{subject:`Reserva Confirmada - ${D.name} (${m.value})`,html:`
                    <div style="font-family: sans-serif; color: #333;">
                        <h2 style="color: #D4AF37;">Reserva Confirmada</h2>
                        <p>Olá <strong>${document.getElementById("res-name").value}</strong>,</p>
                        <p>A sua reserva no <strong>${D.name}</strong> foi registada com sucesso.</p>
                        <hr style="border: 0; border-top: 1px solid #eee; margin: 20px 0;">
                        <ul>
                            <li><strong>Data:</strong> ${m.value}</li>
                            <li><strong>Hora:</strong> ${y.value}</li>
                            <li><strong>Pessoas:</strong> ${p.value}</li>
                        </ul>
                        <p>Se precisar de cancelar, por favor contacte-nos por telefone: ${D.contact.phone}.</p>
                        <p><em>Obrigado pela preferência!</em></p>
                    </div>
                `}};if(n.tables&&n.tables.length>0){const o=parseInt(p.value),a=y.value,[r,i]=a.split(":").map(Number),d=r*60+i,c=n.resDuration||60,t=d+c,l=q(A(L,"reservations"),$("date","==",m.value)),g=await G(l),u=[];g.forEach(h=>{const x=h.data();if(x.assignedTable){const[M,w]=x.time.split(":").map(Number),S=M*60+w,C=S+c;if(S<t&&d<C){const O=x.assignedTable.split("+");u.push(...O)}}});const I=n.tables.filter(h=>!u.includes(h.id)),f=te(o,I);if(!f){alert("Desculpe, não há mesas disponíveis para este período. Por favor escolha outro horário."),v.classList.add("hidden"),v.classList.remove("flex");return}f.tables.length===1?(e.assignedTable=f.tables[0].id,e.assignedTableName=f.tables[0].name):(e.assignedTable=f.tables.map(h=>h.id).join("+"),e.assignedTableName=f.tables.map(h=>h.name).join(" + "))}await W(A(L,"reservations"),e),j.classList.add("hidden"),R.classList.remove("hidden")}catch(e){console.error("Error writing document: ",e);const o=e&&e.message||String(e),a=e&&e.code||"unknown";alert(`Ocorreu um erro ao registar a reserva.

Detalhes: ${o}
Código: ${a}`)}finally{v.classList.add("hidden"),v.classList.remove("flex")}});X.addEventListener("click",()=>{j.reset(),b.innerHTML='<div class="col-span-full text-gray-400 text-sm italic p-4 border border-dashed border-gray-200 rounded-lg text-center bg-neutral-50">Selecione uma data para ver disponibilidade</div>',y.value="",T.classList.add("hidden","opacity-0"),j.classList.remove("hidden"),R.classList.add("hidden")});
